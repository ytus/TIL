# Javascript

## `Array.reduce` doesn't need the initial value

_"If `initialValue` is provided in the call to reduce, 
then `accumulator` will be equal to `initialValue` and `currentValue` will be equal to the first value in the array. 
If no `initialValue` was provided, then accumulator will be equal to the first value in the array 
and `currentValue` will be equal to the second."_

~ http://devdocs.io/javascript/global_objects/array/reduce

## Object destructuring and default values

It's possible to use destructuring to retrieve a value from a hierarchy of objects even if some part of it is missing: 

~~~ js
const present = {
  first: {
    second: {
      third: {
        value: 'something'
      }
    }
  }
};

const missing = {
  // no `first`
};

const {first: {second: {third: {value: v1}}}={}} = present;
console.log('v1=', v1); // -> "v1=" "something"

const {first: {second: {third: {value: v2}={}}={}}={}} = missing;
console.log('v2=', v2); // -> "v2=" undefined (and no errors!)
~~~

## Promise vs. Task (or Future)

_Promises are inherently stateful & impure, 
but you can hoist the callback pattern into a type similar to a Task 
or Future (variously named in different languages) 
just by storing the binary function that hooks callbacks 
up to some async effect. (...) But this achieves two things that Promises don't: 
it's lazy instead of eager (and hence, pure), 
and it has a synchronously exposed return value._

~ http://degoes.net/articles/destroy-all-ifs#comment-3137616342

~ https://jsbin.com/guwuqac/edit?js,console

(& https://hackernoon.com/from-callback-to-future-functor-monad-6c86d9c16cb5 )

~~~ js
const Task = (fork) => ({
  fork: fork,
  map: (fn) => Task(
    (reject, resolve) => fork(reject, x => resolve(fn(x)))
  )
})
  
const delayedFive = Task((reject,resolve) => setTimeout(resolve,400,5))
const logError = (e) => console.log('error=', e);
const logOutput = (out) => console.log('out=' + out)

delayedFive
  .map((i) => i * 2)
  .map((i) => i + 3)
  .fork(logError, logOutput); // -> "out=13"
~~~
  
